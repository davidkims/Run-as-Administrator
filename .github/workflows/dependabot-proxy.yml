name: Validate Workflow Syntax
on:
  push:
    paths:
      - '.github/workflows/**'
  pull_request:
    paths:
      - '.github/workflows/**'

jobs:
  validate-syntax:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Validate workflow syntax
        run: |
          # GitHub의 내장 검증 기능 사용
          echo "Validating workflow files..."
          for file in .github/workflows/*.yml .github/workflows/*.yaml; do
            if [ -f "$file" ]; then
              echo "Validating $file"
              # GitHub CLI를 사용한 검증
              gh workflow view "$file" > /dev/null 2>&1
              if [ $? -eq 0 ]; then
                echo "✓ $file is valid"
              else
                echo "✗ $file has syntax errors"
                exit 1
              fi
            fi
          done
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
