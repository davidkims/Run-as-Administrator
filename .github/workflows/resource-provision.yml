name: Increase Disk and Memory

on:
  workflow_dispatch:

jobs:
  expand:
    runs-on: ubuntu-latest
    timeout-minutes: 30  # ì‘ì—… ì™„ë£Œ ë³´ì¥ì„ ìœ„í•œ íƒ€ì„ì•„ì›ƒ ì„¤ì •
    steps:
      - name: ğŸ§¹ Free Disk Space
        run: |
          sudo rm -rf /usr/local/lib/android
          sudo rm -rf /usr/share/dotnet
          sudo rm -rf /opt/ghc
          sudo docker system prune -af || true
          sudo apt clean
          sudo rm -rf /var/lib/apt/lists/*
          df -h

      - name: ğŸ§® Add Swap for Memory
        run: |
          # ê¸°ì¡´ ìŠ¤ì™‘ ë¹„í™œì„±í™” ë° ì œê±° (ì¡´ì¬í•  ê²½ìš°)
          sudo swapoff -a
          sudo rm -f /swapfile

          # ìƒˆë¡œìš´ 20GB ìŠ¤ì™‘ íŒŒì¼ ìƒì„± ë° í™œì„±í™”
          sudo fallocate -l 20G /swapfile
          sudo chmod 600 /swapfile
          sudo mkswap /swapfile
          sudo swapon /swapfile
          echo '/swapfile none swap sw 0 0' | sudo tee -a /etc/fstab
          free -h

      - name: ğŸ“ˆ Extend Disk Space (ì„ì‹œ ë³¼ë¥¨ í™•ì¥)
        run: |
          # ì„ì‹œ ë””ë ‰í† ë¦¬ë¥¼ ë” í° ë””ìŠ¤í¬ ê³µê°„ì´ ìˆëŠ” ê³³ìœ¼ë¡œ ì´ë™
          sudo mkdir -p /mnt/temp
          sudo mount -t tmpfs -o size=10G tmpfs /mnt/temp
          export TEMP=/mnt/temp
          export TMPDIR=/mnt/temp
          df -h
